module.exports=function(t){var n={};function i(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var s in t)i.d(e,s,function(n){return t[n]}.bind(null,s));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=14)}([function(t,n){t.exports=flarum.core.compat.app},function(t,n){t.exports=flarum.core.compat["components/Button"]},function(t,n){t.exports=flarum.core.compat.Model},function(t,n){t.exports=flarum.core.compat["components/Dropdown"]},function(t,n){t.exports=flarum.core.compat["components/Select"]},function(t,n){t.exports=flarum.core.compat["components/ExtensionPage"]},function(t,n){t.exports=flarum.core.compat["components/Alert"]},function(t,n){t.exports=flarum.core.compat["components/LoadingModal"]},function(t,n){t.exports=flarum.core.compat["utils/extractText"]},function(t,n){t.exports=flarum.core.compat["utils/isExtensionEnabled"]},function(t,n){t.exports=flarum.core.compat["utils/ItemList"]},function(t,n){t.exports=flarum.core.compat.extend},function(t,n){t.exports=flarum.core.compat["components/AdminLinkButton"]},function(t,n){t.exports=flarum.core.compat["components/AdminNav"]},function(t,n,i){"use strict";i.r(n);i(11);var e=i(0),s=i.n(e);i(12),i(13);function a(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function o(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function r(t,n,i){return n in t?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i,t}var l=i(2),u=i.n(l),c=function(t){function n(){for(var n,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];return r(a(n=t.call.apply(t,[this].concat(e))||this),"key",u.a.attribute("key")),r(a(n),"locales",u.a.attribute("locales")),n}return o(n,t),n}(u.a),f=function(t){function n(){for(var n,i=arguments.length,e=new Array(i),s=0;s<i;s++)e[s]=arguments[s];return r(a(n=t.call.apply(t,[this].concat(e))||this),"key",u.a.attribute("key")),r(a(n),"locale",u.a.attribute("locale")),r(a(n),"value",u.a.attribute("value")),n}return o(n,t),n.prototype.apiEndpoint=function(){return"/fof/linguist/strings"+(this.exists?"/"+this.data.id:"")},n}(u.a),g=i(5),h=i.n(g),p=i(1),d=i.n(p),y=i(3),v=i.n(y),x=i(4),b=i.n(x),w=i(6),F=i.n(w),k=i(7),T=i.n(k),L=i(8),O=i.n(L),S=i(9),E=i.n(S),K=function(){var t=[];for(var n in s.a.data.locales)s.a.data.locales.hasOwnProperty(n)&&t.push({key:n,name:s.a.data.locales[n]});return t},P=i(10),N=i.n(P),B=function(t,n){if(!n)return t;var i=n.toLowerCase(),e=new RegExp(i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"i");return t.replace(e,"<fof-highlight>$&<fof-highlight>").split("<fof-highlight>").map((function(t){return t.toLowerCase()===i?m("span.FoF-Linguist-Highlight",t):t}))},I=function(){function t(){}var n=t.prototype;return n.oninit=function(t){var n=this;this.stringKey=t.attrs.stringKey,this.locale=t.attrs.locale,this.localeKey=this.locale?this.locale.key:null,this.originalString=this.localeKey&&this.stringKey.locales().hasOwnProperty(this.localeKey)?this.stringKey.locales()[this.localeKey]:null,this.string=s.a.store.all("fof-linguist-string").find((function(t){return t.key()===n.stringKey.key()&&t.locale()===n.localeKey})),this.value=this.string?this.string.value():"",this.dirty=!1,this.processing=!1;var i=Object.keys(this.stringKey.locales()).some((function(t){return-1!==n.stringKey.locales()[t].indexOf("\n")}));this.inputType="input",(i||-1!==this.value.indexOf("\n"))&&(this.inputType="textarea")},n.view=function(t){var n=this,i=this.originalString?this.originalString:"("+s.a.translator.trans("fof-linguist.admin.placeholder."+(this.localeKey?"not-translated":"all-locales"))+")";return m(".FoF-Linguist-Locale",[m("label.FoF-Linguist-Label",this.localeName()),m(".FoF-Linguist-Field",{className:(this.value?"FoF-Linguist-Field--with-value":"")+(this.originalString?" FoF-Linguist-Field--with-original-string":""),title:i},[m(".FoF-Linguist-Field-Wrap",[m(this.inputType,{className:"FormControl FoF-Linguist-Input",value:this.value,oninput:function(t){n.value=t.target.value,n.dirty=!0,n.value||n.string||(n.dirty=!1)},disabled:this.processing}),m(".FoF-Linguist-Placeholder",[m("span.FoF-Linguist-Placeholder-Hint",s.a.translator.trans("fof-linguist.admin.placeholder.hint"))," ",m("span",this.originalString?B(i,t.attrs.highlight):i)])])]),m(".FoF-Linguist-Controls",this.actions(t.attrs.onchange).toArray())])},n.localeName=function(){return this.locale?[this.locale.name+" (",m("code",this.locale.key),")"]:s.a.translator.trans("fof-linguist.admin.locales.all")},n.actions=function(t){var n=this,i=new N.a;return i.add("apply",d.a.component({type:"button",className:"Button Button--primary",loading:this.processing,disabled:!this.dirty,onclick:function(){n.saveString(t)}},s.a.translator.trans("fof-linguist.admin.buttons.apply"))),i.add("reset",d.a.component({type:"button",className:"Button",loading:this.processing,disabled:!this.dirty&&!this.string,onclick:function(){n.deleteString(t)}},s.a.translator.trans("fof-linguist.admin.buttons.reset"))),this.originalString&&i.add("copy-original",d.a.component({type:"button",className:"Button",loading:this.processing,onclick:function(){n.value=n.originalString,n.dirty=!0}},s.a.translator.trans("fof-linguist.admin.buttons.copy-original"))),i},n.saveString=function(t){var n=this;this.value?(this.string||(this.string=s.a.store.createRecord("fof-linguist-string",{attributes:{key:this.stringKey.key(),locale:this.localeKey,value:""}})),this.string.data.attributes.value=this.value,this.string.locale()||delete this.string.data.attributes.locale,this.processing=!0,this.string.save(this.string.data.attributes).then((function(){n.processing=!1,n.dirty=!1,t(),m.redraw()})).catch((function(t){throw n.processing=!1,t}))):this.deleteString(t)},n.deleteString=function(t){var n=this;this.string?(this.processing=!0,this.string.delete().then((function(){n.processing=!1,n.dirty=!1,n.string=null,n.value="",t(),m.redraw()})).catch((function(t){throw n.processing=!1,t}))):(this.value="",this.dirty=!1)},t}(),j=function(){function t(){}return t.prototype.view=function(t){var n=t.attrs,i=n.stringKey,e=n.highlight,s=n.onchange;return m(".FoF-Linguist-Key",[m(".FoF-Linguist-Key-Code",m("code",B(i.key(),e))),m(".FoF-Linguist-Locales",[].concat(K().map((function(t){return m(I,{key:t.key,locale:t,stringKey:i,highlight:e,onchange:s})})),[m(I,{key:"all",locale:null,stringKey:i,highlight:e,onchange:s})]))])},t}(),C=function(t){function n(){return t.apply(this,arguments)||this}o(n,t);var i=n.prototype;return i.oninit=function(n){var i=this;t.prototype.oninit.call(this,n),this.numberOfResultsToShow=20,this.filters={search:"",withOwnTranslations:!1,missingTranslationsNegation:"without",missingTranslationsType:"any",missingTranslationsInLocales:[],forExtension:null},this.results=[],this.extensions=[],Promise.all([s.a.request({method:"GET",url:s.a.forum.attribute("apiUrl")+"/fof/linguist/strings"}).then((function(t){s.a.store.pushPayload(t)})),s.a.request({method:"GET",url:s.a.forum.attribute("apiUrl")+"/fof/linguist/string-keys"}).then((function(t){var n=s.a.store.pushPayload(t);Object.keys(s.a.data.extensions).forEach((function(t){var e=s.a.data.extensions[t];E()(t)&&!e.extra.hasOwnProperty("flarum-locale")&&i.extensions.push({extension:e,canBeTranslated:-1!==n.findIndex((function(n){return 0===n.key().indexOf(t+".")}))})}))}))]).then((function(){i.applyFilters()}))},i.content=function(){var t=this,n=this.results.slice(0,this.numberOfResultsToShow);return m(".container",[m("div","1"===s.a.data.settings["fof.linguist.should-clear-cache"]?F.a.component({dismissible:!1,controls:[d.a.component({className:"Button Button--link",onclick:function(){s.a.modal.show(T.a),s.a.request({method:"DELETE",url:s.a.forum.attribute("apiUrl")+"/cache"}).then((function(){return window.location.reload()}))}},s.a.translator.trans("fof-linguist.admin.clear-cache.button"))]},s.a.translator.trans("fof-linguist.admin.clear-cache.text")):null),m(".FoF-Linguist-Filters",[m("input.FormControl",{value:this.filters.search,oninput:function(n){t.filters.search=n.target.value,t.applyFilters()},placeholder:s.a.translator.trans("fof-linguist.admin.filters.search")}),d.a.component({className:"Button"+(this.filters.withOwnTranslations?" FoF-Linguist-Filter--Selected":""),icon:"far fa-"+(this.filters.withOwnTranslations?"check-square":"square"),onclick:function(){t.filters.withOwnTranslations=!t.filters.withOwnTranslations,t.applyFilters()}},s.a.translator.trans("fof-linguist.admin.filters.with-own-translations")),v.a.component({buttonClassName:"Button"+(this.filters.forExtension?" FoF-Linguist-Filter--Selected":""),label:s.a.translator.trans("fof-linguist.admin.filters.for-extension")},this.extensions.map((function(n){return d.a.component({className:"Button"+(n.canBeTranslated?"":" disabled"),icon:"far fa-"+(t.filters.forExtension===n.extension.id?"check-square":"square"),onclick:function(i){if(!n.canBeTranslated)return i.stopPropagation(),void alert(O()(s.a.translator.trans("fof-linguist.admin.filters.for-extension-unavailable",{namespace:n.extension.id})));t.filters.forExtension===n.extension.id?t.filters.forExtension=null:t.filters.forExtension=n.extension.id,t.applyFilters()}},n.extension.extra["flarum-extension"].title)}))),v.a.component({buttonClassName:"Button"+(this.filters.missingTranslationsInLocale?" FoF-Linguist-Filter--Selected":""),label:s.a.translator.trans("fof-linguist.admin.filters.missing")},[m(".FoF-Linguist-Missing-Filter",{onclick:function(t){t.stopPropagation()}},[b.a.component({value:this.filters.missingTranslationsNegation,onchange:function(n){t.filters.missingTranslationsNegation=n,t.filters.missingTranslationsInLocale&&t.applyFilters()},options:{without:s.a.translator.trans("fof-linguist.admin.filters.negation-options.without"),with:s.a.translator.trans("fof-linguist.admin.filters.negation-options.with")}}),b.a.component({value:this.filters.missingTranslationsType,onchange:function(n){t.filters.missingTranslationsType=n,t.filters.missingTranslationsInLocale&&t.applyFilters()},options:{any:s.a.translator.trans("fof-linguist.admin.filters.type-options.any"),original:s.a.translator.trans("fof-linguist.admin.filters.type-options.original"),own:s.a.translator.trans("fof-linguist.admin.filters.type-options.own")}}),m("p",s.a.translator.trans("fof-linguist.admin.filters.missing-middle-label"))])].concat(K().map((function(n){return d.a.component({className:"Button",icon:"far fa-"+(t.filters.missingTranslationsInLocale===n.key?"check-square":"square"),onclick:function(){t.filters.missingTranslationsInLocale===n.key?t.filters.missingTranslationsInLocale=null:t.filters.missingTranslationsInLocale=n.key,t.applyFilters()}},n.name+" ("+n.key+")")}))))]),m("div",n.map((function(n){return m(j,{key:n.id(),stringKey:n,highlight:t.filters.search,onchange:function(){s.a.data.settings["fof.linguist.should-clear-cache"]="1"}})}))),m(".FoF-Linguist-Results",[s.a.translator.trans("fof-linguist.admin.filters.results",{shown:n.length+"",total:this.results.length+""})," ",this.results.length>n.length?d.a.component({className:"Button",onclick:function(){t.numberOfResultsToShow+=20}},s.a.translator.trans("fof-linguist.admin.buttons.load-more")):null])])},i.applyFilters=function(){var t=this;this.numberOfResultsToShow=20;var n=s.a.store.all("fof-linguist-string").map((function(t){return t.key()})),i={};K().forEach((function(t){i[t.key]=s.a.store.all("fof-linguist-string").filter((function(n){return n.locale()===t.key})).map((function(t){return t.key()}))}));var e="";this.filters.search&&(e=this.filters.search.toLowerCase()),this.results=s.a.store.all("fof-linguist-string-key").filter((function(s){if(t.filters.withOwnTranslations&&-1===n.indexOf(s.key()))return!1;if(t.filters.missingTranslationsInLocale){var a=s.locales().hasOwnProperty(t.filters.missingTranslationsInLocale),o=-1!==i[t.filters.missingTranslationsInLocale].indexOf(s.key()),r=!1;switch(t.filters.missingTranslationsType){case"any":r=a||o;break;case"original":r=a;break;case"own":r=o}if("without"===t.filters.missingTranslationsNegation&&(r=!r),!r)return!1}if(t.filters.forExtension&&0!==s.key().indexOf(t.filters.forExtension+"."))return!1;if(e){if(-1!==s.key().toLowerCase().indexOf(e))return!0;var l=s.locales();for(var u in l)if(l.hasOwnProperty(u)&&-1!==l[u].toLowerCase().indexOf(e))return!0;return!1}return!0})),m.redraw()},n}(h.a);s.a.initializers.add("fof-linguist",(function(t){t.store.models["fof-linguist-string-key"]=c,t.store.models["fof-linguist-string"]=f,t.extensionData.for("fof-linguist").registerPage(C)}))}]);
//# sourceMappingURL=admin.js.map